function initCalendar(){for(var e=0;e<12;e++){(n=document.createElement("option")).value=String(e),n.text=monthNames[e],monthSelect.appendChild(n)}for(var t=today.getFullYear()-100;t<=today.getFullYear();t++){var n;(n=document.createElement("option")).value=String(t),n.text=String(t),yearSelect.appendChild(n)}for(var a=0;a<6;a++){for(var r=document.getElementById("week"+(a+1)),l=[],d=0;d<7;d++){var i=document.createElement("td");r.appendChild(i),l.push(i)}cells.push(l)}document.addEventListener("click",documentClick,!1),calendar.addEventListener("change",yearMonthChange,!1),calendar.addEventListener("click",dayClick,!1),input.addEventListener("mousedown",inputDOBMouseDown,!1),input.addEventListener("change",dateChanged,!1),updateCalendar(today),setInputValue("")}function updateCalendar(e){monthSelect.value=e.getMonth(),yearSelect.value=e.getFullYear();var t=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,n=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),a=0;cells.forEach(function(e){return e.forEach(function(e){e.innerText=""})});for(var r=1;r<=n;r++)0===(t=(t+1)%7)&&a++,cells[a][t].innerText=r,e.getDate()===r?cells[a][t].className="selected-day":cells[a][t].className="";setInputValue((currentDate=e).getDate()+"."+("0"+(currentDate.getMonth()+1)).slice(-2)+"."+currentDate.getFullYear())}function inputDOBMouseDown(e){document.activeElement.id===input.id?(nextCalendarState=!1,hideCalendar()):(nextCalendarState=!0,showCalendar())}function showCalendar(){calendar.style.visibility="visible"}function hideCalendar(){calendar.style.visibility="hidden"}function documentClick(e){void 0!==nextCalendarState?(nextCalendarState||document.activeElement.blur(),nextCalendarState=void 0):e.target.id!==monthSelect.id&&e.target.id!==yearSelect.id&&hideCalendar()}function yearMonthChange(){updateCalendar(new Date(+yearSelect.value,+monthSelect.value,1))}function dayClick(e){if("TD"===e.target.tagName){var t=e.target.innerText;if(""===t)return;updateCalendar(new Date(currentDate.getFullYear(),currentDate.getMonth(),t)),hideCalendar()}}function parseDate(e){var t=e.split(".");if(3===t.length){var n=t[0],a=t[1],r=t[2];if(!(r<0||a<1||12<a||n<1||n>new Date(r,a,0).getDate()))return new Date(r,a-1,n)}}function dateChanged(){if(ignoreChanged)ignoreChanged=!1;else{var e=parseDate(input.value);void 0!==e&&updateCalendar(e)}}function setInputValue(e){input.value=e;var t=document.createEvent("Event");t.initEvent("change",!0,!1),ignoreChanged=!0,input.dispatchEvent(t)}var nextCalendarState,monthSelect=document.getElementById("calendar-month"),yearSelect=document.getElementById("calendar-year"),calendar=document.getElementById("calendar"),cells=[],today=new Date,input=document.getElementById("dob"),ignoreChanged=!1,currentDate=new Date;initCalendar();